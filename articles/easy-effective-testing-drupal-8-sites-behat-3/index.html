<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="no-js">
  <head>
    <meta charset="utf-8" />
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-31931832-1"></script>
<script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments)};gtag("js", new Date());gtag("config", "UA-31931832-1", {"groups":"default","anonymize_ip":true});</script>
<link rel="canonical" href="https://www.codepositive.com/articles/easy-effective-testing-drupal-8-sites-behat-3" />
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="ImageToolbar" content="false" />
<link rel="shortcut icon" href="/core/misc/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="revision" href="https://www.codepositive.com/articles/easy-effective-testing-drupal-8-sites-behat-3" />

    <title>Easy &amp; effective testing for Drupal 8 sites with Behat 3 | Code Positive Services</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_JQyZ9StD4-4I5jikYtL8icbvn1b-f6xMTWUzpXDhKlc.css" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_J2_MQaG34kuvM8HwGZyTmQX4uVKvfEx-qY2t19V3fbE.css" />

    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

  </head>
  <body class="lang-en section-articles path-node node--type-page">
  <a href="#main-content" class="visually-hidden focusable skip-link">
    Skip to main content
  </a>
  
    <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    

<div class="off-canvas-wrapper">
  <div class="inner-wrap off-canvas-wrapper-inner" id="inner-wrap" data-off-canvas-wrapper>
    <aside id="left-off-canvas-menu" class="off-canvas left-off-canvas-menu position-left" role="complementary" data-off-canvas>
      
    </aside>

    <aside id="right-off-canvas-menu" class="off-canvas right-off-canvas-menu position-right" role="complementary" data-off-canvas>
      
    </aside>

    <div class="off-canvas-content expanded" data-off-canvas-content>
      
      <header class="row collapse expanded" role="banner" aria-label="Site header">
                  <div class="large-12 columns expanded">
              <div>
    <nav role="navigation" aria-labelledby="block-zurb-child-main-menu-menu" id="block-zurb-child-main-menu" class="block-zurb-child-main-menu">
            
  <h2 class="block-title visually-hidden" id="block-zurb-child-main-menu-menu">Main navigation</h2>
  

        

    <div id="top-bar-sticky-container" data-sticky-container>
      <div  class="sticky large-12" data-sticky data-top-anchor="top-bar-sticky-container" data-btm-anchor="9999999" data-margin-top="0" data-margin-bottom="0" data-options="stickyOn:small">
      <div class="title-bar" data-responsive-toggle="main-menu" data-hide-for="medium">
        <button class="menu-icon" type="button" data-toggle></button>
        <div class="title-bar-title"></div>
      </div>
      <nav class="top-bar" id="main-menu" role="navigation">
        <div class="top-bar-left">
          <a href="/">
            <img src="/themes/custom/zurb_child/images/misc/logo.png" >
          </a>

        </div>
        <div class="top-bar-right">
                                <ul class="menu vertical medium-horizontal" data-disable-hover="true" data-responsive-menu="drilldown medium-dropdown">
                                        <li>
        <a href="/services/drupal-consulting" title="Drupal Consulting" data-drupal-link-system-path="node/7">Consulting</a>
              </li>
                              <li>
        <a href="/services/drupal-development" title="Drupal Development" data-drupal-link-system-path="node/8">Development</a>
              </li>
                              <li>
        <a href="/services/drupal-support" title="Drupal support &amp; maintenance" data-drupal-link-system-path="node/9">Support</a>
              </li>
                              <li>
        <a href="/contact" title="Contact Code Positive Services" data-drupal-link-system-path="node/11">Talk To Us</a>
              </li>
        </ul>
  
                            </div>
      </nav>
    </div>
    </div>
  

  </nav>

  </div>

          </div>
              </header>

      <div class="row expanded">
                              </div>

      
      
      <div class="row collapse expanded">
        <main id="main" class="large-12 columns collapse expanded" role="main">
                      <div class="region-highlighted panel"><div data-drupal-messages-fallback class="hidden"></div></div>                    <a id="main-content"></a>
                    <section>
              <div>
      
  <section id="block-zurb-child-page-title" class="block-zurb-child-page-title block block-core block-page-title-block text-center"  style="background: url(https://www.codepositive.com/sites/default/files/2021-01/behat_drupal_testing.png) no-repeat center; background-size: cover;">


<div class="border">


  


  
  <h1><span property="schema:name" class="field-wrapper">Easy &amp; effective testing for Drupal 8 sites with Behat 3</span>
</h1>




</div>

  </section>
<section id="block-zurb-child-content" class="block-zurb-child-content block block-system block-system-main-block">
  
  
    

  
          <article id="node-23"  role="article" about="/articles/easy-effective-testing-drupal-8-sites-behat-3" typeof="schema:WebPage">

  
      <span property="schema:name" content="Easy &amp; effective testing for Drupal 8 sites with Behat 3" class="hidden"></span>


  
    <div class="view-mode-full">
    
      <div class="field-wrapper field field--name-field-slices field--type-entity-reference-revisions field--label-hidden field__items">
              <div class="field__item">  <div class="paragraph paragraph--type--body paragraph--view-mode--default">
          
            <div class="field-wrapper field field--name-field-message field--type-text-long field--label-hidden field__item"><p><span>Testing is the process of running through the expected use of a site feature with the intent of finding bugs. </span><span>To automate this process we use a tool called <strong>Behat</strong> which allows us to create tests in two layers. </span></p>

<p><span>The first layer is a readable description of what we are testing, in Behat this is called a <strong>Feature</strong>. A feature can contain multiple instances of how it works, these are called <strong>Scenarios</strong>. </span></p>

<p><span>The second layer is the implementation where we associate <strong>PHP code</strong> to the steps defined in a scenario to automate each specific step.</span> If you'd like to find out more about Behat and testing have a look at our <a data-entity-type="node" data-entity-uuid="abb6b98a-71f4-4ff9-8489-7392c124bc11" href="/articles/benefits-behat" target="_blank" title="Benefits of Behat">benefits of Behat article</a>.</p>

<p>Now lets have a look at how testing your Drupal site has never been easier thanks to Behat 3 and the Behat Drupal extension....</p>

<p>The hardest job is installing Behat and configuring exactly which extensions and drivers you need in place.</p>

<p>Fortunately for us the folks who built the <a class="external-link" href="https://www.drupal.org/project/drupalextension" target="_blank">Behat Drupal extension</a> have provided some great documentation, so before I get on to talking about the benefits and limitations of the Behat extension, here's an article that takes you through the steps of <a class="external-link" href="http://behat-drupal-extension.readthedocs.io/en/3.1/globalinstall.html" target="_blank">setting up Behat with the Drupal extension</a> on your local machine.</p>

<h2>Behat Drupal Limitations</h2>

<p>So the major limitation that we came up against is that to really make use of all the available functions the Behat Drupal extension provides, you need to run tests from the same server that the site being tested is running on.</p>

<p>Now, dependent on your testing process this may not actually be a limitation.</p>

<p>For us it was, we had multiple environments setup online that we wanted any of our developers to be able to run tests against without requiring them to go through the steps of setting up the site, getting the latest tests and then running them.</p>

<p>To simplify the testing process we used Jenkins to automate [spinning up a virtual server with everything required to run Behat and a copy of the site being tested]. <a href="https://jenkins.io/" target="_blank">Jenkins</a> is an Open Source automation server written in Java that can automate many different manual processes and it's a great fit tasks like this which require lots of repetative technical steps.</p>

<p>Automating the testing process with Jenkins means that developers only need to click a button and wait until they receive a message once tests had completed with the results.</p>

<h2>Behat Drupal Benefits</h2>

<p>The main reason for running tests from the same server that the site being tested is that it makes <strong>Drush</strong> commands available to the tests.<br />
 </p>

<p>To quote the <a href="http://www.drush.org/en/master/" target="_blank">Drush docs</a> :</p>

<p>"Drush is a command line shell and Unix scripting interface for Drupal. Drush core ships with lots of useful commands for interacting with code like modules/themes/profiles. Similarly, it runs update.php, executes sql queries and DB migrations, and misc utilities like run cron or clear cache."</p>

<p>You will need to point the driver to your local site directory in your <em>behat.yml</em> configuration file to utilise the available commands. As well as using available functions provided by the Drupal extension you can also create custom functions which can access Drush as well.</p>

<p>One feature we really appreciated is that when tests use the Drupal extension to log in as a specific role, it uses Drush to spin up a new user with the role you specified, does all the following steps in your scenario, and then deletes that user and any content that was created by it before finishing the test. The reason we like this so much is that it means no tests will fail due to it previously running on the same site, which make the tests a lot more reliable and predictable.</p>

<p>So to summarise the benefit is access to Drush features like:</p>

<ul><li><span>Clearing Drupal caches</span></li>
	<li><span>Running cron</span></li>
	<li><span>Creating/deleting users</span></li>
	<li><span>Changing a users role</span></li>
	<li><span><span>Creating, editing and deleting content</span></span></li>
</ul><p>I could list many more useful features that <strong>Drush</strong> has, but that will be the topic of another article.</p>

<h2>Ready for the bigger picture?</h2>

<p>For more in-depth guidance on Behat and BDD come to one of our <a href="/services/drupal-consulting" title="Drupal Consulting">Quality Assurance training</a> courses.</p>
</div>
      
      </div>
</div>
          </div>
  
  </div>

  
  

</article>

    
    
  </section>

  </div>

          </section>
        </main>
      </div>
              <footer class="row expanded">
                                <div id="footer-middle" class="large-12 columns expanded">
                <div>
    <section id="block-email" class="block-email block block-block-content block-block-contenta0ce5286-1ce0-457a-832d-a2a1ae93f7c9">
  
  
    

  
          
            <div class="field-wrapper body field field--name-body field--type-text-with-summary field--label-hidden field__item"><p><a href="mailto:services@codepositive.com" title="Email Code Positive Services"><img alt="Email" src="/themes/custom/zurb_child/images/contact/email-white.png" /></a>  <span><a href="mailto:services@codepositive.com" title="Email Code Positive Services">services@codepositive.com</a></span></p>
</div>
      
    
    
  </section>
<section id="block-phone" class="block-phone block block-block-content block-block-content11adf858-d3e1-437e-8ac5-efd41933f05d">
  
  
    

  
          
            <div class="field-wrapper body field field--name-body field--type-text-with-summary field--label-hidden field__item"><p><a href="tel:+442081330223"><img alt="Phone" src="/themes/custom/zurb_child/images/contact/mobile-white.png" /></a> <a href="tel:+442081330223"> <span>+44 (0) 20 8133 0223</span></a></p>
</div>
      
    
    
  </section>
<section id="block-footersocialmedia" class="block-footersocialmedia block block-block-content block-block-content94438e23-86d9-4fc3-8037-237b86d99703">
  
  
    

  
          
            <div class="field-wrapper body field field--name-body field--type-text-with-summary field--label-hidden field__item"><div><a href="http://www.facebook.com/pages/Code-Positive/83396297540" target="_blank" title="Facebook"><img alt="Facebook" src="/themes/custom/zurb_child/images/social_media/facebook_1.png" /></a></div>

<div><a href="https://twitter.com/#!/codepositive" target="_blank" title="Twitter"><img alt="Twitter" src="/themes/custom/zurb_child/images/social_media/twitter_1.png" /></a></div>

<div><a href="https://www.linkedin.com/company/15160028/" target="_blank" title="LinkedIn"><img alt="Linkedin" src="/themes/custom/zurb_child/images/social_media/linkedin_0.png" /></a></div>
</div>
      
    
    
  </section>

  </div>

            </div>
                                <div id="footer-last" class="large-12 columns expanded">
                <div>
    <section id="block-footercopyright" class="block-footercopyright block block-block-content block-block-contentc187d04b-daa3-4de7-9f27-e37f5d35cd16">
  
  
    

  
          
            <div class="field-wrapper body field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>© Copyright Code Positive Services 2021 All rights reserved.  Registered in England: 10986978</p></div>
      
    
    
  </section>

  </div>

            </div>
                  </footer>
                </div>
  </div>
</div>

  </div>

  
  <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/23","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"google_analytics":{"account":"UA-31931832-1","trackOutbound":true,"trackMailto":true,"trackDownload":true,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackDomainMode":1},"user":{"uid":0,"permissionsHash":"145c30764ef6d467862006ee9ad8f350cb43f88a98b240a651ce1a1bb01adbd3"}}</script>
<script src="/sites/default/files/js/js_sUOS1RSx0rXoVG1h-0vNvwlxNjQTQLUFVADLj2_RNuk.js"></script>

  </body>
</html>
